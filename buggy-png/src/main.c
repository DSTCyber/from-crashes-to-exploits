/*
 * main.c
 *
 * The main entry point for the buggy PNG parser.
 *
 * Copyright (c) 2018 DST Group, for the Commonwealth of Australia.
 *
 * All rights reserved.
 */

#include <stdio.h>

#include "png.h"

int main(int argc, char *argv[]) {
  FILE *infile;
  png_struct_t *png_ptr;

  if (argc != 2) {
    fprintf(stderr, "usage: %s /path/to/png/file\n", argv[0]);
    return 1;
  }

  if (!(infile = fopen(argv[1], "rb"))) {
    fprintf(stderr, "error: unable to open %s\n", argv[1]);
    return 1;
  }

  if (!(png_ptr = png_read(infile))) {
    fprintf(stderr, "error: unable to parse as PNG\n");
    return 1;
  }

  png_destroy(png_ptr);

  return 0;
}
